<UserControl x:Class="TermSnap.Views.AIToolsPanel"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             Background="{DynamicResource SurfaceBrush}"
             MinWidth="400">

    <UserControl.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVis"/>

        <!-- íƒ­ ë²„íŠ¼ ìŠ¤íƒ€ì¼ -->
        <Style x:Key="TabButtonStyle" TargetType="RadioButton">
            <Setter Property="Background" Value="{DynamicResource SurfaceBrush}"/>
            <Setter Property="Foreground" Value="{DynamicResource TextSecondaryBrush}"/>
            <Setter Property="Padding" Value="16,8"/>
            <Setter Property="Margin" Value="2,0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="RadioButton">
                        <Border x:Name="Border"
                                Background="{TemplateBinding Background}"
                                CornerRadius="4"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter Property="Background" Value="{DynamicResource PrimaryBrush}"/>
                                <Setter Property="Foreground" Value="White"/>
                            </Trigger>
                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition Property="IsMouseOver" Value="True"/>
                                    <Condition Property="IsChecked" Value="False"/>
                                </MultiTrigger.Conditions>
                                <Setter TargetName="Border" Property="Background" Value="{DynamicResource CardBrush}"/>
                                <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}"/>
                            </MultiTrigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </UserControl.Resources>

    <Border CornerRadius="8"
            BorderBrush="{DynamicResource BorderBrush}"
            BorderThickness="1"
            Background="{DynamicResource SurfaceBrush}">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- í—¤ë” -->
            <Border Grid.Row="0"
                    Background="{DynamicResource PrimaryBrush}"
                    CornerRadius="8,8,0,0"
                    Padding="12,8">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <StackPanel Grid.Column="0" Orientation="Horizontal">
                        <materialDesign:PackIcon Kind="Robot"
                                                 Width="20" Height="20"
                                                 VerticalAlignment="Center"
                                                 Foreground="White"/>
                        <TextBlock Text="AI Tools"
                                   FontWeight="Bold"
                                   FontSize="14"
                                   Foreground="White"
                                   VerticalAlignment="Center"
                                   Margin="8,0,0,0"/>
                    </StackPanel>

                    <!-- Claude Hook ì„¤ì • ë²„íŠ¼ -->
                    <Button x:Name="SetupHooksButton"
                            Grid.Column="2"
                            Style="{StaticResource MaterialDesignIconButton}"
                            Width="28" Height="28"
                            Click="SetupHooksButton_Click"
                            ToolTip="Claude ìž¥ê¸°ê¸°ì–µ í›… ì„¤ì • (MEMORY.md, CLAUDE.md ìƒì„±)">
                        <materialDesign:PackIcon Kind="Cog" Width="16" Height="16" Foreground="White"/>
                    </Button>

                    <!-- ë‹«ê¸° ë²„íŠ¼ -->
                    <Button x:Name="CloseButton"
                            Grid.Column="3"
                            Style="{StaticResource MaterialDesignIconButton}"
                            Width="28" Height="28"
                            Click="CloseButton_Click"
                            ToolTip="ë‹«ê¸°">
                        <materialDesign:PackIcon Kind="Close" Width="16" Height="16" Foreground="White"/>
                    </Button>
                </Grid>
            </Border>

            <!-- íƒ­ í—¤ë” -->
            <Border Grid.Row="1" Background="{DynamicResource BackgroundBrush}" Padding="8,6">
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                    <RadioButton x:Name="MemoryTabButton"
                                 IsChecked="True"
                                 Checked="TabButton_Checked"
                                 Tag="Memory"
                                 Style="{StaticResource TabButtonStyle}">
                        <StackPanel Orientation="Horizontal">
                            <materialDesign:PackIcon Kind="Brain" Width="16" Height="16" VerticalAlignment="Center"/>
                            <TextBlock Text="Memory" Margin="6,0,0,0" VerticalAlignment="Center" FontSize="12"/>
                        </StackPanel>
                    </RadioButton>
                    <RadioButton x:Name="OrchestratorTabButton"
                                 Checked="TabButton_Checked"
                                 Tag="Orchestrator"
                                 Style="{StaticResource TabButtonStyle}">
                        <StackPanel Orientation="Horizontal">
                            <materialDesign:PackIcon Kind="AccountGroup" Width="16" Height="16" VerticalAlignment="Center"/>
                            <TextBlock Text="Orchestrator" Margin="6,0,0,0" VerticalAlignment="Center" FontSize="12"/>
                        </StackPanel>
                    </RadioButton>
                    <RadioButton x:Name="SkillsTabButton"
                                 Checked="TabButton_Checked"
                                 Tag="Skills"
                                 Style="{StaticResource TabButtonStyle}">
                        <StackPanel Orientation="Horizontal">
                            <materialDesign:PackIcon Kind="Puzzle" Width="16" Height="16" VerticalAlignment="Center"/>
                            <TextBlock Text="Skills" Margin="6,0,0,0" VerticalAlignment="Center" FontSize="12"/>
                        </StackPanel>
                    </RadioButton>
                </StackPanel>
            </Border>

            <!-- íƒ­ ì»¨í…ì¸  -->
            <Grid Grid.Row="2">
                <!-- Memory ì»¨í…ì¸  -->
                <Grid x:Name="MemoryContent" Visibility="Visible">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- ì„œë¸Œíƒ­ ë²„íŠ¼ -->
                    <Border Grid.Row="0" Background="{DynamicResource CardBrush}"
                            Padding="8,4" Margin="8,8,8,0" CornerRadius="6">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                            <RadioButton x:Name="MemorySubTabMemories"
                                         IsChecked="True"
                                         Checked="MemorySubTab_Checked"
                                         Tag="Memories"
                                         Style="{StaticResource TabButtonStyle}">
                                <StackPanel Orientation="Horizontal">
                                    <materialDesign:PackIcon Kind="Brain" Width="14" Height="14" VerticalAlignment="Center"/>
                                    <TextBlock Text="ê¸°ì–µ" Margin="4,0,0,0" VerticalAlignment="Center" FontSize="11"/>
                                </StackPanel>
                            </RadioButton>
                            <RadioButton x:Name="MemorySubTabConversations"
                                         Checked="MemorySubTab_Checked"
                                         Tag="Conversations"
                                         Style="{StaticResource TabButtonStyle}">
                                <StackPanel Orientation="Horizontal">
                                    <materialDesign:PackIcon Kind="Chat" Width="14" Height="14" VerticalAlignment="Center"/>
                                    <TextBlock Text="ëŒ€í™”" Margin="4,0,0,0" VerticalAlignment="Center" FontSize="11"/>
                                </StackPanel>
                            </RadioButton>
                            <RadioButton x:Name="MemorySubTabSearch"
                                         Checked="MemorySubTab_Checked"
                                         Tag="Search"
                                         Style="{StaticResource TabButtonStyle}">
                                <StackPanel Orientation="Horizontal">
                                    <materialDesign:PackIcon Kind="Magnify" Width="14" Height="14" VerticalAlignment="Center"/>
                                    <TextBlock Text="ê²€ìƒ‰" Margin="4,0,0,0" VerticalAlignment="Center" FontSize="11"/>
                                </StackPanel>
                            </RadioButton>
                        </StackPanel>
                    </Border>

                    <!-- ì„œë¸Œíƒ­ ì»¨í…ì¸  ì˜ì—­ -->
                    <Grid Grid.Row="1">
                        <!-- ê¸°ì–µ ì„œë¸Œíƒ­ -->
                        <Grid x:Name="MemoriesSubContent" Visibility="Visible">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <!-- íƒ€ìž… í•„í„° -->
                            <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="12,8,12,0">
                                <TextBlock Text="íƒ€ìž…:" VerticalAlignment="Center" Margin="0,0,8,0"
                                           Foreground="{DynamicResource TextPrimaryBrush}" FontSize="12"/>
                                <ComboBox x:Name="MemoryTypeFilterCombo" Width="140"
                                          SelectionChanged="MemoryTypeFilterCombo_SelectionChanged"
                                          Foreground="{DynamicResource TextPrimaryBrush}"
                                          Background="{DynamicResource CardBrush}"
                                          FontSize="11">
                                    <ComboBoxItem Content="ì „ì²´" Tag="" IsSelected="True"/>
                                    <ComboBoxItem Content="ðŸ“Œ ì‚¬ì‹¤" Tag="Fact"/>
                                    <ComboBoxItem Content="ðŸ’¡ ì„ í˜¸ë„" Tag="Preference"/>
                                    <ComboBoxItem Content="ðŸ”§ ê¸°ìˆ  ìŠ¤íƒ" Tag="TechStack"/>
                                    <ComboBoxItem Content="ðŸ“ í”„ë¡œì íŠ¸" Tag="Project"/>
                                    <ComboBoxItem Content="âš ï¸ ì§€ì¹¨" Tag="Instruction"/>
                                    <ComboBoxItem Content="ðŸ“š í•™ìŠµëœ êµí›ˆ" Tag="Lesson"/>
                                </ComboBox>

                                <Button Style="{StaticResource MaterialDesignFlatButton}"
                                        Margin="8,0,0,0" Click="MemoryRefreshButton_Click"
                                        ToolTip="ìƒˆë¡œê³ ì¹¨" Width="32" Height="32">
                                    <materialDesign:PackIcon Kind="Refresh" Width="16" Height="16"/>
                                </Button>
                            </StackPanel>

                            <!-- ë©”ëª¨ë¦¬ ëª©ë¡ (ìŠ¤í¬ë¡¤ ê°€ëŠ¥) -->
                            <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto"
                                          Margin="8,8,8,0"
                                          PreviewMouseWheel="ScrollViewer_PreviewMouseWheel">
                                <ListBox x:Name="MemoryList"
                                         ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                         ScrollViewer.VerticalScrollBarVisibility="Disabled"
                                         SelectionChanged="MemoryList_SelectionChanged"
                                         MouseDoubleClick="MemoryList_MouseDoubleClick"
                                         Background="Transparent"
                                         BorderThickness="0">
                                    <ListBox.ItemContainerStyle>
                                        <Style TargetType="ListBoxItem">
                                            <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                            <Setter Property="Padding" Value="0"/>
                                            <Setter Property="Margin" Value="0"/>
                                        </Style>
                                    </ListBox.ItemContainerStyle>
                                    <ListBox.ItemTemplate>
                                        <DataTemplate>
                                            <Border Padding="10" Margin="0,3"
                                                    Background="{DynamicResource CardBrush}"
                                                    CornerRadius="6"
                                                    BorderBrush="{DynamicResource BorderBrush}"
                                                    BorderThickness="1">
                                                <Grid>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                    </Grid.RowDefinitions>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>

                                                    <StackPanel Grid.Row="0" Grid.Column="0" Orientation="Horizontal">
                                                        <TextBlock Text="{Binding TypeIcon}" FontSize="14"
                                                                   VerticalAlignment="Center" Margin="0,0,6,0"/>
                                                        <TextBlock Text="{Binding Content}"
                                                                   TextWrapping="Wrap"
                                                                   Foreground="{DynamicResource TextPrimaryBrush}"
                                                                   FontWeight="Medium" FontSize="12"/>
                                                    </StackPanel>

                                                    <Button Grid.Row="0" Grid.Column="1"
                                                            Style="{StaticResource MaterialDesignIconForegroundButton}"
                                                            Width="22" Height="22"
                                                            Click="DeleteMemory_Click"
                                                            Tag="{Binding Id}"
                                                            ToolTip="ì‚­ì œ">
                                                        <materialDesign:PackIcon Kind="Delete" Width="14" Height="14"/>
                                                    </Button>

                                                    <StackPanel Grid.Row="1" Grid.ColumnSpan="2"
                                                                Orientation="Horizontal" Margin="0,4,0,0">
                                                        <TextBlock Text="{Binding TypeName}"
                                                                   Foreground="{DynamicResource TextSecondaryBrush}"
                                                                   FontSize="10"/>
                                                        <TextBlock Text=" Â· " Foreground="{DynamicResource TextSecondaryBrush}" FontSize="10"/>
                                                        <TextBlock Text="{Binding ImportanceText}"
                                                                   Foreground="{DynamicResource TextSecondaryBrush}"
                                                                   FontSize="10"/>
                                                    </StackPanel>
                                                </Grid>
                                            </Border>
                                        </DataTemplate>
                                    </ListBox.ItemTemplate>
                                </ListBox>
                            </ScrollViewer>
                        </Grid>

                        <!-- ëŒ€í™” ì„œë¸Œíƒ­ -->
                        <Grid x:Name="ConversationsSubContent" Visibility="Collapsed">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <!-- ëŒ€í™” ëª©ë¡ í—¤ë” -->
                            <Grid Grid.Row="0" Margin="12,8,12,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="ðŸ“… ìµœê·¼ ëŒ€í™” ê¸°ë¡" FontWeight="Medium" FontSize="12"
                                           Foreground="{DynamicResource TextPrimaryBrush}"
                                           VerticalAlignment="Center"/>
                                <Button Grid.Column="1"
                                        Style="{StaticResource MaterialDesignFlatButton}"
                                        Click="ConversationRefreshButton_Click"
                                        ToolTip="ìƒˆë¡œê³ ì¹¨" Width="32" Height="32">
                                    <materialDesign:PackIcon Kind="Refresh" Width="16" Height="16"/>
                                </Button>
                            </Grid>

                            <!-- ëŒ€í™” ëª©ë¡ (ìŠ¤í¬ë¡¤ ê°€ëŠ¥) -->
                            <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto"
                                          Margin="8,8,8,0"
                                          PreviewMouseWheel="ScrollViewer_PreviewMouseWheel">
                                <ListBox x:Name="ConversationList"
                                         ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                         ScrollViewer.VerticalScrollBarVisibility="Disabled"
                                         SelectionChanged="ConversationList_SelectionChanged"
                                         Background="Transparent" BorderThickness="0">
                                    <ListBox.ItemContainerStyle>
                                        <Style TargetType="ListBoxItem">
                                            <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                            <Setter Property="Padding" Value="0"/>
                                            <Setter Property="Margin" Value="0"/>
                                        </Style>
                                    </ListBox.ItemContainerStyle>
                                    <ListBox.ItemTemplate>
                                        <DataTemplate>
                                            <Border Padding="10" Margin="0,3"
                                                    Background="{DynamicResource CardBrush}"
                                                    CornerRadius="6"
                                                    BorderBrush="{DynamicResource BorderBrush}"
                                                    BorderThickness="1">
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>

                                                    <TextBlock Grid.Column="0" Text="ðŸ“…"
                                                               VerticalAlignment="Center" Margin="0,0,8,0" FontSize="16"/>
                                                    <StackPanel Grid.Column="1">
                                                        <TextBlock Text="{Binding DateDisplay}"
                                                                   FontWeight="Medium" FontSize="12"
                                                                   Foreground="{DynamicResource TextPrimaryBrush}"/>
                                                        <TextBlock Text="{Binding Summary}"
                                                                   FontSize="10" TextTrimming="CharacterEllipsis"
                                                                   Foreground="{DynamicResource TextSecondaryBrush}"
                                                                   Margin="0,2,0,0"/>
                                                    </StackPanel>
                                                    <StackPanel Grid.Column="2" VerticalAlignment="Center">
                                                        <TextBlock Text="{Binding KeywordCount}"
                                                                   FontSize="10"
                                                                   Foreground="{DynamicResource TextSecondaryBrush}"
                                                                   HorizontalAlignment="Right"/>
                                                        <Button Style="{StaticResource MaterialDesignIconForegroundButton}"
                                                                Width="22" Height="22" Margin="0,2,0,0"
                                                                Click="OpenConversationFile_Click"
                                                                Tag="{Binding FilePath}"
                                                                ToolTip="íŒŒì¼ ì—´ê¸°">
                                                            <materialDesign:PackIcon Kind="OpenInNew" Width="12" Height="12"/>
                                                        </Button>
                                                    </StackPanel>
                                                </Grid>
                                            </Border>
                                        </DataTemplate>
                                    </ListBox.ItemTemplate>
                                </ListBox>
                            </ScrollViewer>

                            <!-- ëŒ€í™” ë¯¸ë¦¬ë³´ê¸° -->
                            <Border x:Name="ConversationPreviewBorder" Grid.Row="2"
                                    Visibility="Collapsed"
                                    Background="{DynamicResource CardBrush}"
                                    CornerRadius="6" Padding="10" Margin="8,8,8,0"
                                    BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1"
                                    MaxHeight="150">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>
                                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,4">
                                        <TextBlock x:Name="ConversationPreviewTitle"
                                                   Text="ë¯¸ë¦¬ë³´ê¸°" FontWeight="Bold" FontSize="11"
                                                   Foreground="{DynamicResource TextPrimaryBrush}"/>
                                    </StackPanel>
                                    <ScrollViewer Grid.Row="1" MaxHeight="100"
                                                  VerticalScrollBarVisibility="Auto">
                                        <TextBlock x:Name="ConversationPreviewText"
                                                   Text="" TextWrapping="Wrap" FontSize="10"
                                                   Foreground="{DynamicResource TextSecondaryBrush}"/>
                                    </ScrollViewer>
                                </Grid>
                            </Border>

                            <!-- ëŒ€í™” ì—†ìŒ ë©”ì‹œì§€ -->
                            <TextBlock x:Name="NoConversationsText"
                                       Grid.Row="1"
                                       Text="ëŒ€í™” ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤"
                                       Visibility="Collapsed"
                                       HorizontalAlignment="Center"
                                       VerticalAlignment="Center"
                                       Foreground="{DynamicResource TextSecondaryBrush}"
                                       FontSize="12"/>
                        </Grid>

                        <!-- ê²€ìƒ‰ ì„œë¸Œíƒ­ -->
                        <Grid x:Name="SearchSubContent" Visibility="Collapsed">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <!-- ê²€ìƒ‰ ìž…ë ¥ -->
                            <Grid Grid.Row="0" Margin="12,8,12,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <TextBox x:Name="MemorySearchBox"
                                         materialDesign:HintAssist.Hint="ê¸°ì–µ + ëŒ€í™” í†µí•© ê²€ìƒ‰..."
                                         materialDesign:HintAssist.Foreground="{DynamicResource TextSecondaryBrush}"
                                         Background="{DynamicResource CardBrush}"
                                         Foreground="{DynamicResource TextPrimaryBrush}"
                                         BorderBrush="{DynamicResource BorderBrush}"
                                         CaretBrush="{DynamicResource TextPrimaryBrush}"
                                         Padding="10,8"
                                         Margin="0,0,8,0"
                                         FontSize="12"
                                         KeyDown="MemorySearchBox_KeyDown"/>

                                <Button Grid.Column="1"
                                        Style="{StaticResource MaterialDesignFlatButton}"
                                        Click="MemorySearchButton_Click"
                                        Foreground="{DynamicResource PrimaryBrush}"
                                        ToolTip="ê²€ìƒ‰" Width="36" Height="36">
                                    <materialDesign:PackIcon Kind="Magnify" Width="18" Height="18"/>
                                </Button>
                            </Grid>

                            <!-- ê²€ìƒ‰ ê²°ê³¼ (ìŠ¤í¬ë¡¤ ê°€ëŠ¥) -->
                            <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto"
                                          Margin="8,8,8,0"
                                          PreviewMouseWheel="ScrollViewer_PreviewMouseWheel">
                                <StackPanel>
                                    <!-- ê²€ìƒ‰ ê²°ê³¼: ê¸°ì–µ -->
                                    <Border x:Name="SearchMemoryResultsBorder"
                                            Visibility="Collapsed" Margin="0,0,0,8">
                                        <StackPanel>
                                            <TextBlock Text="ðŸ§  ê¸°ì–µ ê²€ìƒ‰ ê²°ê³¼" FontWeight="Medium" FontSize="12"
                                                       Foreground="{DynamicResource TextPrimaryBrush}"
                                                       Margin="4,0,0,8"/>
                                            <ListBox x:Name="SearchMemoryResultsList"
                                                     ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                                     ScrollViewer.VerticalScrollBarVisibility="Disabled"
                                                     Background="Transparent" BorderThickness="0">
                                                <ListBox.ItemContainerStyle>
                                                    <Style TargetType="ListBoxItem">
                                                        <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                                        <Setter Property="Padding" Value="0"/>
                                                        <Setter Property="Margin" Value="0"/>
                                                    </Style>
                                                </ListBox.ItemContainerStyle>
                                                <ListBox.ItemTemplate>
                                                    <DataTemplate>
                                                        <Border Padding="8" Margin="0,2"
                                                                Background="{DynamicResource CardBrush}"
                                                                CornerRadius="4"
                                                                BorderBrush="{DynamicResource BorderBrush}"
                                                                BorderThickness="1">
                                                            <StackPanel Orientation="Horizontal">
                                                                <TextBlock Text="{Binding TypeIcon}" FontSize="12"
                                                                           VerticalAlignment="Center" Margin="0,0,6,0"/>
                                                                <TextBlock Text="{Binding Content}"
                                                                           TextWrapping="Wrap" FontSize="11"
                                                                           Foreground="{DynamicResource TextPrimaryBrush}"/>
                                                            </StackPanel>
                                                        </Border>
                                                    </DataTemplate>
                                                </ListBox.ItemTemplate>
                                            </ListBox>
                                        </StackPanel>
                                    </Border>

                                    <!-- ê²€ìƒ‰ ê²°ê³¼: ëŒ€í™” -->
                                    <Border x:Name="SearchConversationResultsBorder"
                                            Visibility="Collapsed">
                                        <StackPanel>
                                            <TextBlock Text="ðŸ’¬ ëŒ€í™” ê²€ìƒ‰ ê²°ê³¼" FontWeight="Medium" FontSize="12"
                                                       Foreground="{DynamicResource TextPrimaryBrush}"
                                                       Margin="4,0,0,8"/>
                                            <ListBox x:Name="SearchConversationResultsList"
                                                     ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                                     ScrollViewer.VerticalScrollBarVisibility="Disabled"
                                                     Background="Transparent" BorderThickness="0">
                                                <ListBox.ItemContainerStyle>
                                                    <Style TargetType="ListBoxItem">
                                                        <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                                        <Setter Property="Padding" Value="0"/>
                                                        <Setter Property="Margin" Value="0"/>
                                                    </Style>
                                                </ListBox.ItemContainerStyle>
                                                <ListBox.ItemTemplate>
                                                    <DataTemplate>
                                                        <Border Padding="8" Margin="0,2"
                                                                Background="{DynamicResource CardBrush}"
                                                                CornerRadius="4"
                                                                BorderBrush="{DynamicResource BorderBrush}"
                                                                BorderThickness="1">
                                                            <StackPanel>
                                                                <TextBlock Text="{Binding DateDisplay}"
                                                                           FontWeight="Medium" FontSize="11"
                                                                           Foreground="{DynamicResource TextPrimaryBrush}"/>
                                                                <TextBlock Text="{Binding Summary}"
                                                                           FontSize="10" TextTrimming="CharacterEllipsis"
                                                                           Foreground="{DynamicResource TextSecondaryBrush}"
                                                                           Margin="0,2,0,0"/>
                                                            </StackPanel>
                                                        </Border>
                                                    </DataTemplate>
                                                </ListBox.ItemTemplate>
                                            </ListBox>
                                        </StackPanel>
                                    </Border>

                                    <!-- ê²€ìƒ‰ ì•ˆë‚´ ë©”ì‹œì§€ -->
                                    <TextBlock x:Name="SearchPlaceholderText"
                                               Text="í‚¤ì›Œë“œë¥¼ ìž…ë ¥í•˜ì—¬ ê¸°ì–µê³¼ ëŒ€í™”ë¥¼ ê²€ìƒ‰í•˜ì„¸ìš”"
                                               HorizontalAlignment="Center"
                                               Foreground="{DynamicResource TextSecondaryBrush}"
                                               FontSize="12" Margin="0,40,0,0"/>
                                </StackPanel>
                            </ScrollViewer>
                        </Grid>
                    </Grid>

                    <!-- í•˜ë‹¨ ì»¨íŠ¸ë¡¤ -->
                    <Border Grid.Row="2"
                            Background="{DynamicResource CardBrush}"
                            BorderBrush="{DynamicResource BorderBrush}"
                            BorderThickness="0,1,0,0"
                            Padding="12,6">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock x:Name="MemoryStatsText" Text="ì´ 0ê°œì˜ ê¸°ì–µ"
                                       VerticalAlignment="Center" FontSize="11"
                                       Foreground="{DynamicResource TextSecondaryBrush}"/>

                            <StackPanel Grid.Column="1" Orientation="Horizontal">
                                <Button Style="{StaticResource MaterialDesignFlatButton}"
                                        Click="AddMemoryButton_Click"
                                        ToolTip="ìƒˆ ê¸°ì–µ ì¶”ê°€" Height="28">
                                    <StackPanel Orientation="Horizontal">
                                        <materialDesign:PackIcon Kind="Plus" Width="14" Height="14" VerticalAlignment="Center"/>
                                        <TextBlock Text="ì¶”ê°€" Margin="4,0,0,0" FontSize="11"/>
                                    </StackPanel>
                                </Button>

                                <Button Style="{StaticResource MaterialDesignFlatButton}"
                                        Click="ExportMemoryButton_Click"
                                        Margin="4,0,0,0"
                                        ToolTip="MEMORY.md íŒŒì¼ ì—´ê¸°" Height="28" Width="28">
                                    <materialDesign:PackIcon Kind="FileDocumentEdit" Width="14" Height="14"/>
                                </Button>
                            </StackPanel>
                        </Grid>
                    </Border>
                </Grid>

                <!-- Orchestrator ì»¨í…ì¸  -->
                <ScrollViewer x:Name="OrchestratorContent" Visibility="Collapsed"
                              VerticalScrollBarVisibility="Auto"
                              PreviewMouseWheel="ScrollViewer_PreviewMouseWheel">
                    <Grid Margin="12">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- AI Provider ìƒíƒœ -->
                        <Border Grid.Row="0" Background="{DynamicResource CardBrush}"
                                CornerRadius="6" Padding="12" Margin="0,0,0,12">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="AI Providers" FontWeight="SemiBold" FontSize="12"
                                               Foreground="{DynamicResource TextPrimaryBrush}"/>
                                    <TextBlock x:Name="OrchestratorModeText"
                                               Text="ê°ì§€ ì¤‘..."
                                               FontSize="11"
                                               Foreground="{DynamicResource TextSecondaryBrush}"
                                               Margin="0,4,0,0"/>
                                </StackPanel>

                                <StackPanel Grid.Column="1" Orientation="Horizontal">
                                    <Border x:Name="ClaudeStatusBadge" CornerRadius="4" Padding="6,2" Margin="4,0"
                                            Background="{DynamicResource BorderBrush}">
                                        <TextBlock Text="Claude" FontSize="10" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                    </Border>
                                    <Border x:Name="CodexStatusBadge" CornerRadius="4" Padding="6,2" Margin="4,0"
                                            Background="{DynamicResource BorderBrush}">
                                        <TextBlock Text="Codex" FontSize="10" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                    </Border>
                                    <Border x:Name="GeminiStatusBadge" CornerRadius="4" Padding="6,2" Margin="4,0"
                                            Background="{DynamicResource BorderBrush}">
                                        <TextBlock Text="Gemini" FontSize="10" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                    </Border>
                                </StackPanel>
                            </Grid>
                        </Border>

                        <!-- ì§„í–‰ ìƒí™© -->
                        <Border Grid.Row="1" Background="{DynamicResource CardBrush}"
                                CornerRadius="6" Padding="12" Margin="0,0,0,12">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <Grid Grid.Row="0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="ì§„í–‰ ìƒí™©" FontWeight="SemiBold" FontSize="12"
                                               Foreground="{DynamicResource TextPrimaryBrush}"/>
                                    <TextBlock x:Name="OrchestratorProgressText" Grid.Column="1"
                                               Text="0%" FontSize="12"
                                               Foreground="{DynamicResource PrimaryBrush}"/>
                                </Grid>

                                <ProgressBar x:Name="OrchestratorProgressBar"
                                             Grid.Row="1" Value="0" Maximum="100" Height="8"
                                             Margin="0,8,0,0"
                                             Foreground="{DynamicResource PrimaryBrush}"
                                             Background="{DynamicResource BorderBrush}"/>

                                <Grid Grid.Row="2" Margin="0,8,0,0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock x:Name="OrchestratorPendingText" Grid.Column="0"
                                               Text="ëŒ€ê¸°: 0" FontSize="10" HorizontalAlignment="Center"
                                               Foreground="{DynamicResource TextSecondaryBrush}"/>
                                    <TextBlock x:Name="OrchestratorInProgressText" Grid.Column="1"
                                               Text="ì§„í–‰: 0" FontSize="10" HorizontalAlignment="Center"
                                               Foreground="{DynamicResource WarningBrush}"/>
                                    <TextBlock x:Name="OrchestratorCompletedText" Grid.Column="2"
                                               Text="ì™„ë£Œ: 0" FontSize="10" HorizontalAlignment="Center"
                                               Foreground="{DynamicResource SuccessBrush}"/>
                                    <TextBlock x:Name="OrchestratorFailedText" Grid.Column="3"
                                               Text="ì‹¤íŒ¨: 0" FontSize="10" HorizontalAlignment="Center"
                                               Foreground="{DynamicResource ErrorBrush}"/>
                                </Grid>
                            </Grid>
                        </Border>

                        <!-- í”Œëžœ íŒŒì¼ ì„ íƒ -->
                        <Grid Grid.Row="2">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock Grid.Column="0" Text="í”Œëžœ íŒŒì¼"
                                       FontWeight="SemiBold" FontSize="12"
                                       Foreground="{DynamicResource TextPrimaryBrush}"
                                       VerticalAlignment="Center"/>

                            <Button Grid.Column="1"
                                    Style="{StaticResource MaterialDesignFlatButton}"
                                    Click="OrchestratorLoadPlanButton_Click"
                                    ToolTip="í”Œëžœ íŒŒì¼ ìƒˆë¡œê³ ì¹¨">
                                <materialDesign:PackIcon Kind="Refresh" Width="16" Height="16"/>
                            </Button>
                        </Grid>

                        <!-- í”Œëžœ íŒŒì¼ ëª©ë¡ -->
                        <Border Grid.Row="3" Background="{DynamicResource CardBrush}"
                                CornerRadius="6" Padding="8" Margin="0,6,0,0"
                                BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" MaxHeight="120"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <!-- í”Œëžœ íŒŒì¼ ë¦¬ìŠ¤íŠ¸ -->
                                <ListBox x:Name="PlanFileList" Grid.Row="0"
                                         MaxHeight="100"
                                         SelectionChanged="PlanFileList_SelectionChanged"
                                         Background="Transparent" BorderThickness="0">
                                    <ListBox.ItemContainerStyle>
                                        <Style TargetType="ListBoxItem">
                                            <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                            <Setter Property="Padding" Value="8,4"/>
                                        </Style>
                                    </ListBox.ItemContainerStyle>
                                    <ListBox.ItemTemplate>
                                        <DataTemplate>
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                <TextBlock Grid.Column="0" Text="ðŸ“„" Margin="0,0,8,0"/>
                                                <TextBlock Grid.Column="1" Text="{Binding FileName}"
                                                           Foreground="{DynamicResource TextPrimaryBrush}"/>
                                                <TextBlock Grid.Column="2" Text="{Binding ModifiedTime}"
                                                           FontSize="10"
                                                           Foreground="{DynamicResource TextSecondaryBrush}"/>
                                            </Grid>
                                        </DataTemplate>
                                    </ListBox.ItemTemplate>
                                </ListBox>

                                <!-- í”Œëžœ ë¯¸ë¦¬ë³´ê¸° -->
                                <Expander Grid.Row="1" Header="í”Œëžœ ë¯¸ë¦¬ë³´ê¸°" Margin="0,8,0,0"
                                          IsExpanded="False"
                                          Foreground="{DynamicResource TextPrimaryBrush}">
                                    <ScrollViewer MaxHeight="150" VerticalScrollBarVisibility="Auto">
                                        <TextBlock x:Name="PlanPreviewText"
                                                   Text="í”Œëžœ íŒŒì¼ì„ ì„ íƒí•˜ì„¸ìš”"
                                                   TextWrapping="Wrap"
                                                   FontFamily="Consolas"
                                                   FontSize="11"
                                                   Foreground="{DynamicResource TextSecondaryBrush}"
                                                   Margin="0,8,0,0"/>
                                    </ScrollViewer>
                                </Expander>

                                <!-- í”Œëžœ íŒŒì¼ ì—†ìŒ -->
                                <TextBlock x:Name="NoPlanFilesText"
                                           Text="í”Œëžœ íŒŒì¼ ì—†ìŒ (Claude Codeì—ì„œ plan mode ì‹¤í–‰ í•„ìš”)"
                                           Visibility="Collapsed"
                                           HorizontalAlignment="Center"
                                           Foreground="{DynamicResource TextSecondaryBrush}"
                                           FontSize="11" Margin="0,8,0,8"/>
                            </Grid>
                        </Border>

                        <!-- ë²„íŠ¼ ì˜ì—­ -->
                        <Grid Grid.Row="4" Margin="0,12,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <Button x:Name="OrchestratorRefreshButton"
                                    Grid.Column="0"
                                    Style="{StaticResource MaterialDesignFlatButton}"
                                    HorizontalAlignment="Left"
                                    Click="OrchestratorRefreshButton_Click"
                                    ToolTip="ìƒíƒœ ìƒˆë¡œê³ ì¹¨">
                                <materialDesign:PackIcon Kind="Refresh"/>
                            </Button>

                            <Button x:Name="OrchestratorViewTasksButton"
                                    Grid.Column="1"
                                    Content="íƒœìŠ¤í¬ ë³´ê¸°"
                                    Click="OrchestratorViewTasksButton_Click"
                                    Style="{StaticResource MaterialDesignOutlinedButton}"
                                    Padding="12,6"
                                    Margin="0,0,8,0"/>

                            <Button x:Name="OrchestratorStartButton"
                                    Grid.Column="2"
                                    Content="PM ì‹œìž‘"
                                    Click="OrchestratorStartButton_Click"
                                    Background="{DynamicResource SuccessBrush}"
                                    Foreground="White"
                                    Padding="16,6"
                                    Margin="0,0,8,0"/>

                            <Button x:Name="OrchestratorResetButton"
                                    Grid.Column="3"
                                    Content="ë¦¬ì…‹"
                                    Click="OrchestratorResetButton_Click"
                                    Style="{StaticResource MaterialDesignOutlinedButton}"
                                    Padding="12,6"/>
                        </Grid>
                    </Grid>
                </ScrollViewer>

                <!-- Skills ì»¨í…ì¸  -->
                <Grid x:Name="SkillsContent" Visibility="Collapsed">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- ìŠ¤í¬ë¡¤ ì˜ì—­ -->
                    <ScrollViewer Grid.Row="0"
                                  VerticalScrollBarVisibility="Auto"
                                  PreviewMouseWheel="ScrollViewer_PreviewMouseWheel">
                        <Grid Margin="12,12,12,0">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                        <!-- í”„ë¡œì íŠ¸ ë¶„ì„ ìƒíƒœ -->
                        <Border Grid.Row="0"
                                Background="{DynamicResource CardBrush}"
                                CornerRadius="6"
                                Padding="12"
                                Margin="0,0,0,8">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Column="0">
                                    <TextBlock x:Name="SkillsProjectNameText"
                                               Text="í”„ë¡œì íŠ¸: (ë¶„ì„ ëŒ€ê¸°)"
                                               FontWeight="SemiBold"
                                               Foreground="{DynamicResource TextPrimaryBrush}"/>
                                    <TextBlock x:Name="SkillsStackText"
                                               Text="ê°ì§€ëœ ê¸°ìˆ : -"
                                               FontSize="11"
                                               Foreground="{DynamicResource TextSecondaryBrush}"
                                               Margin="0,4,0,0"/>
                                </StackPanel>

                                <Button x:Name="SkillsAnalyzeButton"
                                        Grid.Column="1"
                                        Style="{StaticResource MaterialDesignFlatButton}"
                                        Click="SkillsAnalyzeButton_Click"
                                        ToolTip="í”„ë¡œì íŠ¸ ê¸°ìˆ  ìŠ¤íƒ ë¶„ì„ ë° ìŠ¤í‚¬ ì¶”ì²œ">
                                    <StackPanel Orientation="Horizontal">
                                        <materialDesign:PackIcon Kind="Magnify" VerticalAlignment="Center"/>
                                        <TextBlock Text="ë¶„ì„" Margin="4,0,0,0"/>
                                    </StackPanel>
                                </Button>
                            </Grid>
                        </Border>

                        <!-- ë¡œë”© ì¸ë””ì¼€ì´í„° -->
                        <ProgressBar x:Name="SkillsProgressBar"
                                     Grid.Row="0"
                                     Height="3"
                                     Margin="0,8,0,0"
                                     IsIndeterminate="True"
                                     Visibility="Collapsed"
                                     Foreground="{DynamicResource PrimaryBrush}"/>

                        <!-- ë¦¬ì†ŒìŠ¤ íƒ€ìž… í•„í„° -->
                        <StackPanel Grid.Row="1" Margin="0,0,0,4">
                            <!-- ì²«ì§¸ ì¤„: íƒ€ìž… í•„í„° -->
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,4">
                                <RadioButton x:Name="SkillsFilterAll"
                                             Content="ì „ì²´"
                                             IsChecked="True"
                                             Checked="SkillsFilter_Checked"
                                             Tag="All"
                                             Margin="0,0,8,0"
                                             Foreground="{DynamicResource TextPrimaryBrush}"/>
                                <RadioButton x:Name="SkillsFilterSkills"
                                             Content="ìŠ¤í‚¬"
                                             Checked="SkillsFilter_Checked"
                                             Tag="Skill"
                                             Margin="0,0,8,0"
                                             Foreground="{DynamicResource TextPrimaryBrush}"/>
                                <RadioButton x:Name="SkillsFilterAgents"
                                             Content="ì—ì´ì „íŠ¸"
                                             Checked="SkillsFilter_Checked"
                                             Tag="Agent"
                                             Margin="0,0,8,0"
                                             Foreground="{DynamicResource TextPrimaryBrush}"/>
                                <RadioButton x:Name="SkillsFilterCommands"
                                             Content="ì»¤ë§¨ë“œ"
                                             Checked="SkillsFilter_Checked"
                                             Tag="Command"
                                             Margin="0,0,8,0"
                                             Foreground="{DynamicResource TextPrimaryBrush}"/>
                                <RadioButton x:Name="SkillsFilterHooks"
                                             Content="í›…"
                                             Checked="SkillsFilter_Checked"
                                             Tag="Hook"
                                             Margin="0,0,8,0"
                                             Foreground="{DynamicResource TextPrimaryBrush}"/>
                                <RadioButton x:Name="SkillsFilterMCP"
                                             Content="MCP"
                                             Checked="SkillsFilter_Checked"
                                             Tag="MCP"
                                             Foreground="{DynamicResource TextPrimaryBrush}"/>
                            </StackPanel>
                            <!-- ë‘˜ì§¸ ì¤„: ì„¤ì¹˜ ìƒíƒœ í•„í„° -->
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="ì„¤ì¹˜:" VerticalAlignment="Center" Margin="0,0,8,0"
                                           Foreground="{DynamicResource TextSecondaryBrush}" FontSize="12"/>
                                <RadioButton x:Name="SkillsInstallFilterAll"
                                             Content="ëª¨ë‘"
                                             IsChecked="True"
                                             Checked="SkillsInstallFilter_Checked"
                                             Tag="All"
                                             GroupName="InstallFilter"
                                             Margin="0,0,8,0"
                                             Foreground="{DynamicResource TextPrimaryBrush}"/>
                                <RadioButton x:Name="SkillsInstallFilterInstalled"
                                             Content="ì„¤ì¹˜ë¨"
                                             Checked="SkillsInstallFilter_Checked"
                                             Tag="Installed"
                                             GroupName="InstallFilter"
                                             Margin="0,0,8,0"
                                             Foreground="{DynamicResource TextPrimaryBrush}"/>
                                <RadioButton x:Name="SkillsInstallFilterNotInstalled"
                                             Content="ë¯¸ì„¤ì¹˜"
                                             Checked="SkillsInstallFilter_Checked"
                                             Tag="NotInstalled"
                                             GroupName="InstallFilter"
                                             Foreground="{DynamicResource TextPrimaryBrush}"/>
                            </StackPanel>
                        </StackPanel>

                        <!-- ì¶”ì²œ ë¦¬ì†ŒìŠ¤ ëª©ë¡ -->
                        <ListBox x:Name="SkillsList" Grid.Row="2"
                                 SelectionMode="Multiple"
                                 ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                 ScrollViewer.VerticalScrollBarVisibility="Disabled"
                                 Background="Transparent"
                                 BorderThickness="0">
                            <ListBox.ItemContainerStyle>
                                <Style TargetType="ListBoxItem">
                                    <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                    <Setter Property="Padding" Value="0"/>
                                    <Setter Property="Margin" Value="0"/>
                                </Style>
                            </ListBox.ItemContainerStyle>
                            <ListBox.ItemTemplate>
                                <DataTemplate>
                                    <Border Padding="10" Margin="0,3"
                                            Background="{DynamicResource CardBrush}"
                                            CornerRadius="6"
                                            BorderBrush="{DynamicResource BorderBrush}"
                                            BorderThickness="1">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>

                                            <!-- ì²´í¬ë°•ìŠ¤ -->
                                            <CheckBox Grid.Column="0"
                                                      IsChecked="{Binding IsSelected, Mode=TwoWay}"
                                                      VerticalAlignment="Center"
                                                      Margin="0,0,8,0"/>

                                            <!-- ì •ë³´ -->
                                            <StackPanel Grid.Column="1">
                                                <StackPanel Orientation="Horizontal">
                                                    <TextBlock Text="{Binding PriorityIcon}"
                                                               FontSize="12"
                                                               VerticalAlignment="Center"
                                                               Margin="0,0,4,0"/>
                                                    <TextBlock Text="{Binding Name}"
                                                               FontWeight="SemiBold"
                                                               Foreground="{DynamicResource TextPrimaryBrush}"/>
                                                    <Border Background="{DynamicResource PrimaryBrush}"
                                                            CornerRadius="3"
                                                            Padding="6,1"
                                                            Margin="8,0,0,0"
                                                            Visibility="{Binding IsInstalled, Converter={StaticResource BoolToVis}}">
                                                        <TextBlock Text="ì„¤ì¹˜ë¨" FontSize="10" Foreground="White"/>
                                                    </Border>
                                                </StackPanel>
                                                <TextBlock Text="{Binding Description}"
                                                           FontSize="11"
                                                           Foreground="{DynamicResource TextSecondaryBrush}"
                                                           TextWrapping="Wrap"
                                                           Margin="0,2,0,0"/>
                                                <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                                                    <Border Background="{DynamicResource BackgroundBrush}"
                                                            CornerRadius="3"
                                                            Padding="6,2">
                                                        <TextBlock Text="{Binding TypeName}"
                                                                   FontSize="10"
                                                                   Foreground="{DynamicResource TextSecondaryBrush}"/>
                                                    </Border>
                                                    <Border Background="{DynamicResource BackgroundBrush}"
                                                            CornerRadius="3"
                                                            Padding="6,2"
                                                            Margin="4,0,0,0">
                                                        <TextBlock Text="{Binding Category}"
                                                                   FontSize="10"
                                                                   Foreground="{DynamicResource TextSecondaryBrush}"/>
                                                    </Border>
                                                </StackPanel>
                                            </StackPanel>

                                            <!-- ì„¤ì¹˜/ì‚­ì œ ë²„íŠ¼ -->
                                            <StackPanel Grid.Column="2" Orientation="Horizontal">
                                                <!-- ì„¤ì¹˜ ë²„íŠ¼ (ì„¤ì¹˜ ì•ˆ ëœ ê²½ìš°) -->
                                                <Button Style="{StaticResource MaterialDesignIconButton}"
                                                        Width="28" Height="28"
                                                        Click="InstallSingleSkill_Click"
                                                        Tag="{Binding}"
                                                        ToolTip="ì„¤ì¹˜"
                                                        Visibility="{Binding IsNotInstalled, Converter={StaticResource BoolToVis}}">
                                                    <materialDesign:PackIcon Kind="Download" Width="16" Height="16"/>
                                                </Button>
                                                <!-- ì‚­ì œ ë²„íŠ¼ (ì„¤ì¹˜ëœ ê²½ìš°) -->
                                                <Button Style="{StaticResource MaterialDesignIconButton}"
                                                        Width="28" Height="28"
                                                        Click="DeleteSingleSkill_Click"
                                                        Tag="{Binding}"
                                                        ToolTip="ì‚­ì œ"
                                                        Foreground="{DynamicResource MaterialDesignValidationErrorBrush}"
                                                        Visibility="{Binding IsInstalled, Converter={StaticResource BoolToVis}}">
                                                    <materialDesign:PackIcon Kind="DeleteOutline" Width="16" Height="16"/>
                                                </Button>
                                            </StackPanel>
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ListBox.ItemTemplate>
                        </ListBox>
                        </Grid>
                    </ScrollViewer>

                    <!-- í‘¸í„° (ê³ ì •) -->
                    <Border Grid.Row="1"
                            Background="{DynamicResource CardBrush}"
                            BorderBrush="{DynamicResource BorderBrush}"
                            BorderThickness="0,1,0,0"
                            Padding="12,8">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock x:Name="SkillsStatsText"
                                       Text="ì¶”ì²œ: 0ê°œ (ì„¤ì¹˜ë¨: 0ê°œ)"
                                       VerticalAlignment="Center"
                                       Foreground="{DynamicResource TextSecondaryBrush}"/>

                            <StackPanel Grid.Column="1" Orientation="Horizontal">
                                <Button Style="{StaticResource MaterialDesignFlatButton}"
                                        Click="SkillsSelectAllButton_Click"
                                        ToolTip="í˜„ìž¬ í•„í„°ì— í•´ë‹¹í•˜ëŠ” í•­ëª© ì „ì²´ ì„ íƒ">
                                    <StackPanel Orientation="Horizontal">
                                        <materialDesign:PackIcon Kind="CheckAll" VerticalAlignment="Center"/>
                                        <TextBlock Text="ì „ì²´ ì„ íƒ" Margin="4,0,0,0"/>
                                    </StackPanel>
                                </Button>

                                <Button x:Name="SkillsActionButton"
                                        Click="SkillsActionButton_Click"
                                        Padding="12,6"
                                        Margin="8,0,0,0">
                                    <StackPanel Orientation="Horizontal">
                                        <materialDesign:PackIcon x:Name="SkillsActionIcon" Kind="Download" VerticalAlignment="Center"/>
                                        <TextBlock x:Name="SkillsActionText" Text="ì„¤ì¹˜" Margin="4,0,0,0"/>
                                    </StackPanel>
                                </Button>
                            </StackPanel>
                        </Grid>
                    </Border>
                </Grid>
            </Grid>
        </Grid>
    </Border>
</UserControl>
