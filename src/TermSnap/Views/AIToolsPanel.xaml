<UserControl x:Class="TermSnap.Views.AIToolsPanel"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             Background="{DynamicResource SurfaceBrush}"
             MinWidth="400">

    <UserControl.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVis"/>

        <!-- íƒ­ ë²„íŠ¼ ìŠ¤íƒ€ì¼ -->
        <Style x:Key="TabButtonStyle" TargetType="RadioButton">
            <Setter Property="Background" Value="{DynamicResource SurfaceBrush}"/>
            <Setter Property="Foreground" Value="{DynamicResource TextSecondaryBrush}"/>
            <Setter Property="Padding" Value="16,8"/>
            <Setter Property="Margin" Value="2,0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="RadioButton">
                        <Border x:Name="Border"
                                Background="{TemplateBinding Background}"
                                CornerRadius="4"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter Property="Background" Value="{DynamicResource PrimaryBrush}"/>
                                <Setter Property="Foreground" Value="White"/>
                            </Trigger>
                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition Property="IsMouseOver" Value="True"/>
                                    <Condition Property="IsChecked" Value="False"/>
                                </MultiTrigger.Conditions>
                                <Setter TargetName="Border" Property="Background" Value="{DynamicResource CardBrush}"/>
                                <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}"/>
                            </MultiTrigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </UserControl.Resources>

    <Border CornerRadius="8"
            BorderBrush="{DynamicResource BorderBrush}"
            BorderThickness="1"
            Background="{DynamicResource SurfaceBrush}">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- í—¤ë” -->
            <Border Grid.Row="0"
                    Background="{DynamicResource PrimaryBrush}"
                    CornerRadius="8,8,0,0"
                    Padding="12,8">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <StackPanel Grid.Column="0" Orientation="Horizontal">
                        <materialDesign:PackIcon Kind="Robot"
                                                 Width="20" Height="20"
                                                 VerticalAlignment="Center"
                                                 Foreground="White"/>
                        <TextBlock Text="AI Tools"
                                   FontWeight="Bold"
                                   FontSize="14"
                                   Foreground="White"
                                   VerticalAlignment="Center"
                                   Margin="8,0,0,0"/>
                    </StackPanel>

                    <!-- Claude Hook ì„¤ì • ë²„íŠ¼ -->
                    <Button x:Name="SetupHooksButton"
                            Grid.Column="2"
                            Style="{StaticResource MaterialDesignIconButton}"
                            Width="28" Height="28"
                            Click="SetupHooksButton_Click"
                            ToolTip="Claude ìž¥ê¸°ê¸°ì–µ í›… ì„¤ì • (MEMORY.md, CLAUDE.md ìƒì„±)">
                        <materialDesign:PackIcon Kind="Cog" Width="16" Height="16" Foreground="White"/>
                    </Button>

                    <!-- ë‹«ê¸° ë²„íŠ¼ -->
                    <Button x:Name="CloseButton"
                            Grid.Column="3"
                            Style="{StaticResource MaterialDesignIconButton}"
                            Width="28" Height="28"
                            Click="CloseButton_Click"
                            ToolTip="ë‹«ê¸°">
                        <materialDesign:PackIcon Kind="Close" Width="16" Height="16" Foreground="White"/>
                    </Button>
                </Grid>
            </Border>

            <!-- íƒ­ í—¤ë” -->
            <Border Grid.Row="1" Background="{DynamicResource BackgroundBrush}" Padding="8,6">
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                    <RadioButton x:Name="MemoryTabButton"
                                 IsChecked="True"
                                 Checked="TabButton_Checked"
                                 Tag="Memory"
                                 Style="{StaticResource TabButtonStyle}">
                        <StackPanel Orientation="Horizontal">
                            <materialDesign:PackIcon Kind="Brain" Width="16" Height="16" VerticalAlignment="Center"/>
                            <TextBlock Text="Memory" Margin="6,0,0,0" VerticalAlignment="Center" FontSize="12"/>
                        </StackPanel>
                    </RadioButton>
                    <RadioButton x:Name="RalphLoopTabButton"
                                 Checked="TabButton_Checked"
                                 Tag="RalphLoop"
                                 Style="{StaticResource TabButtonStyle}">
                        <StackPanel Orientation="Horizontal">
                            <materialDesign:PackIcon Kind="Repeat" Width="16" Height="16" VerticalAlignment="Center"/>
                            <TextBlock Text="Ralph Loop" Margin="6,0,0,0" VerticalAlignment="Center" FontSize="12"/>
                        </StackPanel>
                    </RadioButton>
                    <RadioButton x:Name="GsdTabButton"
                                 Checked="TabButton_Checked"
                                 Tag="GSD"
                                 Style="{StaticResource TabButtonStyle}">
                        <StackPanel Orientation="Horizontal">
                            <materialDesign:PackIcon Kind="FormatListChecks" Width="16" Height="16" VerticalAlignment="Center"/>
                            <TextBlock Text="GSD" Margin="6,0,0,0" VerticalAlignment="Center" FontSize="12"/>
                        </StackPanel>
                    </RadioButton>
                    <RadioButton x:Name="SkillsTabButton"
                                 Checked="TabButton_Checked"
                                 Tag="Skills"
                                 Style="{StaticResource TabButtonStyle}">
                        <StackPanel Orientation="Horizontal">
                            <materialDesign:PackIcon Kind="Puzzle" Width="16" Height="16" VerticalAlignment="Center"/>
                            <TextBlock Text="Skills" Margin="6,0,0,0" VerticalAlignment="Center" FontSize="12"/>
                        </StackPanel>
                    </RadioButton>
                </StackPanel>
            </Border>

            <!-- íƒ­ ì»¨í…ì¸  -->
            <Grid Grid.Row="2">
                <!-- Memory ì»¨í…ì¸  -->
                <ScrollViewer x:Name="MemoryContent" Visibility="Visible"
                              VerticalScrollBarVisibility="Auto">
                    <Grid Margin="12">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- ê²€ìƒ‰ ë° í•„í„° -->
                        <Grid Grid.Row="0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <TextBox x:Name="MemorySearchBox"
                                     materialDesign:HintAssist.Hint="ê¸°ì–µ ê²€ìƒ‰..."
                                     materialDesign:HintAssist.Foreground="{DynamicResource TextSecondaryBrush}"
                                     Background="{DynamicResource CardBrush}"
                                     Foreground="{DynamicResource TextPrimaryBrush}"
                                     BorderBrush="{DynamicResource BorderBrush}"
                                     CaretBrush="{DynamicResource TextPrimaryBrush}"
                                     Padding="10,8"
                                     Margin="0,0,8,0"
                                     KeyDown="MemorySearchBox_KeyDown"/>

                            <Button Grid.Column="1"
                                    Style="{StaticResource MaterialDesignFlatButton}"
                                    Click="MemorySearchButton_Click"
                                    Foreground="{DynamicResource PrimaryBrush}"
                                    ToolTip="ê²€ìƒ‰">
                                <materialDesign:PackIcon Kind="Magnify"/>
                            </Button>
                        </Grid>

                        <!-- íƒ€ìž… í•„í„° -->
                        <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,8,0,0">
                            <TextBlock Text="íƒ€ìž…:" VerticalAlignment="Center" Margin="0,0,8,0"
                                       Foreground="{DynamicResource TextPrimaryBrush}"/>
                            <ComboBox x:Name="MemoryTypeFilterCombo" Width="150"
                                      SelectionChanged="MemoryTypeFilterCombo_SelectionChanged"
                                      Foreground="{DynamicResource TextPrimaryBrush}"
                                      Background="{DynamicResource CardBrush}">
                                <ComboBoxItem Content="ì „ì²´" Tag="" IsSelected="True"/>
                                <ComboBoxItem Content="ðŸ“Œ ì‚¬ì‹¤" Tag="Fact"/>
                                <ComboBoxItem Content="ðŸ’¡ ì„ í˜¸ë„" Tag="Preference"/>
                                <ComboBoxItem Content="ðŸ”§ ê¸°ìˆ  ìŠ¤íƒ" Tag="TechStack"/>
                                <ComboBoxItem Content="ðŸ“ í”„ë¡œì íŠ¸" Tag="Project"/>
                                <ComboBoxItem Content="âš ï¸ ì§€ì¹¨" Tag="Instruction"/>
                                <ComboBoxItem Content="ðŸ“š í•™ìŠµëœ êµí›ˆ" Tag="Lesson"/>
                            </ComboBox>

                            <Button Style="{StaticResource MaterialDesignFlatButton}"
                                    Margin="8,0,0,0" Click="MemoryRefreshButton_Click"
                                    ToolTip="ìƒˆë¡œê³ ì¹¨">
                                <materialDesign:PackIcon Kind="Refresh"/>
                            </Button>
                        </StackPanel>

                        <!-- ë©”ëª¨ë¦¬ ëª©ë¡ -->
                        <ListBox x:Name="MemoryList" Grid.Row="2"
                                 Margin="0,8,0,0"
                                 ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                 SelectionChanged="MemoryList_SelectionChanged"
                                 Background="Transparent"
                                 BorderThickness="0">
                            <ListBox.ItemTemplate>
                                <DataTemplate>
                                    <Border Padding="12" Margin="0,4"
                                            Background="{DynamicResource CardBrush}"
                                            CornerRadius="6"
                                            BorderBrush="{DynamicResource BorderBrush}"
                                            BorderThickness="1">
                                        <Grid>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>

                                            <StackPanel Grid.Row="0" Grid.Column="0" Orientation="Horizontal">
                                                <TextBlock Text="{Binding TypeIcon}" FontSize="16"
                                                           VerticalAlignment="Center" Margin="0,0,8,0"/>
                                                <TextBlock Text="{Binding Content}"
                                                           TextWrapping="Wrap"
                                                           Foreground="{DynamicResource TextPrimaryBrush}"
                                                           FontWeight="Medium"/>
                                            </StackPanel>

                                            <Button Grid.Row="0" Grid.Column="1"
                                                    Style="{StaticResource MaterialDesignIconForegroundButton}"
                                                    Width="24" Height="24"
                                                    Click="DeleteMemory_Click"
                                                    Tag="{Binding Id}"
                                                    ToolTip="ì‚­ì œ">
                                                <materialDesign:PackIcon Kind="Delete" Width="16" Height="16"/>
                                            </Button>

                                            <StackPanel Grid.Row="1" Grid.ColumnSpan="2"
                                                        Orientation="Horizontal" Margin="0,4,0,0">
                                                <TextBlock Text="{Binding TypeName}"
                                                           Foreground="{DynamicResource TextSecondaryBrush}"
                                                           FontSize="11"/>
                                                <TextBlock Text=" Â· " Foreground="{DynamicResource TextSecondaryBrush}" FontSize="11"/>
                                                <TextBlock Text="{Binding ImportanceText}"
                                                           Foreground="{DynamicResource TextSecondaryBrush}"
                                                           FontSize="11"/>
                                            </StackPanel>
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ListBox.ItemTemplate>
                        </ListBox>

                        <!-- í•˜ë‹¨ ì»¨íŠ¸ë¡¤ -->
                        <Grid Grid.Row="3" Margin="0,8,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock x:Name="MemoryStatsText" Text="ì´ 0ê°œì˜ ê¸°ì–µ"
                                       VerticalAlignment="Center"
                                       Foreground="{DynamicResource TextSecondaryBrush}"/>

                            <StackPanel Grid.Column="1" Orientation="Horizontal">
                                <Button Style="{StaticResource MaterialDesignFlatButton}"
                                        Click="AddMemoryButton_Click"
                                        ToolTip="ìƒˆ ê¸°ì–µ ì¶”ê°€">
                                    <StackPanel Orientation="Horizontal">
                                        <materialDesign:PackIcon Kind="Plus" VerticalAlignment="Center"/>
                                        <TextBlock Text="ì¶”ê°€" Margin="4,0,0,0"/>
                                    </StackPanel>
                                </Button>

                                <Button Style="{StaticResource MaterialDesignFlatButton}"
                                        Click="ExportMemoryButton_Click"
                                        Margin="8,0,0,0"
                                        ToolTip="MEMORY.md íŒŒì¼ ì—´ê¸°">
                                    <materialDesign:PackIcon Kind="FileDocumentEdit"/>
                                </Button>
                            </StackPanel>
                        </Grid>
                    </Grid>
                </ScrollViewer>

                <!-- Ralph Loop ì»¨í…ì¸  -->
                <ScrollViewer x:Name="RalphLoopContent" Visibility="Collapsed"
                              VerticalScrollBarVisibility="Auto">
                    <Grid Margin="12">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <TextBlock Grid.Row="0"
                                   Text="PRD (Product Requirements Document)"
                                   FontWeight="SemiBold"
                                   FontSize="12"
                                   Foreground="{DynamicResource TextPrimaryBrush}"
                                   Margin="0,0,0,6"/>

                        <TextBox x:Name="RalphPrdTextBox"
                                 Grid.Row="1"
                                 AcceptsReturn="True"
                                 TextWrapping="Wrap"
                                 VerticalScrollBarVisibility="Auto"
                                 MinHeight="200"
                                 MaxHeight="400"
                                 FontFamily="Consolas"
                                 FontSize="12"
                                 Background="{DynamicResource BackgroundBrush}"
                                 Foreground="{DynamicResource TextPrimaryBrush}"
                                 BorderBrush="{DynamicResource BorderBrush}"
                                 Padding="8"/>

                        <!-- ì§„í–‰ ìƒí™© -->
                        <Grid Grid.Row="2" Margin="0,12,0,0">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <ProgressBar x:Name="RalphProgressBar"
                                         Grid.Row="0"
                                         Value="0"
                                         Maximum="100"
                                         Height="6"
                                         Foreground="{DynamicResource PrimaryBrush}"
                                         Background="{DynamicResource BorderBrush}"/>

                            <Grid Grid.Row="1" Margin="0,8,0,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <TextBlock x:Name="RalphCurrentTaskText"
                                           Grid.Column="0"
                                           FontSize="11"
                                           Foreground="{DynamicResource TextSecondaryBrush}"
                                           TextTrimming="CharacterEllipsis"/>

                                <TextBlock x:Name="RalphIterationText"
                                           Grid.Column="1"
                                           FontSize="11"
                                           Foreground="{DynamicResource TextSecondaryBrush}"
                                           Text="ë°˜ë³µ: 0/100"/>
                            </Grid>
                        </Grid>

                        <!-- ë²„íŠ¼ ì˜ì—­ -->
                        <Grid Grid.Row="3" Margin="0,12,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <ComboBox x:Name="RalphAiCommandCombo"
                                      Grid.Column="0"
                                      Width="120"
                                      HorizontalAlignment="Left"
                                      SelectedIndex="0"
                                      Foreground="{DynamicResource TextPrimaryBrush}"
                                      Background="{DynamicResource CardBrush}">
                                <ComboBoxItem Content="Claude Code" Tag="claude"/>
                                <ComboBoxItem Content="Aider" Tag="aider"/>
                                <ComboBoxItem Content="Codex" Tag="codex"/>
                                <ComboBoxItem Content="Gemini CLI" Tag="gemini"/>
                            </ComboBox>

                            <Button x:Name="RalphStartButton"
                                    Grid.Column="1"
                                    Content="ì‹œìž‘"
                                    Click="RalphStartButton_Click"
                                    Background="{DynamicResource SuccessBrush}"
                                    Foreground="White"
                                    Padding="16,8"
                                    Margin="8,0,0,0"/>

                            <Button x:Name="RalphResetButton"
                                    Grid.Column="2"
                                    Content="ë¦¬ì…‹"
                                    Click="RalphResetButton_Click"
                                    Style="{StaticResource MaterialDesignOutlinedButton}"
                                    Padding="12,8"
                                    Margin="8,0,0,0"/>
                        </Grid>
                    </Grid>
                </ScrollViewer>

                <!-- GSD ì»¨í…ì¸  -->
                <ScrollViewer x:Name="GsdContent" Visibility="Collapsed"
                              VerticalScrollBarVisibility="Auto">
                    <Grid Margin="12">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- Phase ë° Mode ì„ íƒ -->
                        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,8">
                            <TextBlock Text="Phase:"
                                       FontWeight="SemiBold"
                                       FontSize="12"
                                       Foreground="{DynamicResource TextPrimaryBrush}"
                                       VerticalAlignment="Center"
                                       Margin="0,0,8,0"/>
                            <ComboBox x:Name="GsdPhaseCombo"
                                      Width="60"
                                      SelectedIndex="0"
                                      SelectionChanged="GsdPhaseCombo_SelectionChanged"
                                      Foreground="{DynamicResource TextPrimaryBrush}"
                                      Background="{DynamicResource CardBrush}">
                                <ComboBoxItem Content="1"/>
                                <ComboBoxItem Content="2"/>
                                <ComboBoxItem Content="3"/>
                                <ComboBoxItem Content="4"/>
                                <ComboBoxItem Content="5"/>
                            </ComboBox>

                            <TextBlock Text="Mode:"
                                       FontWeight="SemiBold"
                                       FontSize="12"
                                       Foreground="{DynamicResource TextPrimaryBrush}"
                                       VerticalAlignment="Center"
                                       Margin="16,0,8,0"/>
                            <ComboBox x:Name="GsdModeCombo"
                                      Width="100"
                                      SelectedIndex="0"
                                      Foreground="{DynamicResource TextPrimaryBrush}"
                                      Background="{DynamicResource CardBrush}">
                                <ComboBoxItem Content="Interactive" Tag="Interactive"/>
                                <ComboBoxItem Content="Eco" Tag="EcoMode"/>
                                <ComboBoxItem Content="Pipeline" Tag="Pipeline"/>
                                <ComboBoxItem Content="Swarm" Tag="Swarm"/>
                                <ComboBoxItem Content="Expert" Tag="Expert"/>
                            </ComboBox>
                        </StackPanel>

                        <!-- Step ì„ íƒ -->
                        <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,12">
                            <RadioButton x:Name="GsdDiscussRadio"
                                         Content="Discuss"
                                         IsChecked="True"
                                         Checked="GsdStepRadio_Checked"
                                         Tag="Discuss"
                                         Margin="0,0,12,0"
                                         Foreground="{DynamicResource TextPrimaryBrush}"/>
                            <RadioButton x:Name="GsdPlanRadio"
                                         Content="Plan"
                                         Checked="GsdStepRadio_Checked"
                                         Tag="Plan"
                                         Margin="0,0,12,0"
                                         Foreground="{DynamicResource TextPrimaryBrush}"/>
                            <RadioButton x:Name="GsdExecuteRadio"
                                         Content="Execute"
                                         Checked="GsdStepRadio_Checked"
                                         Tag="Execute"
                                         Margin="0,0,12,0"
                                         Foreground="{DynamicResource TextPrimaryBrush}"/>
                            <RadioButton x:Name="GsdVerifyRadio"
                                         Content="Verify"
                                         Checked="GsdStepRadio_Checked"
                                         Tag="Verify"
                                         Foreground="{DynamicResource TextPrimaryBrush}"/>
                        </StackPanel>

                        <!-- ì»¨í…ì¸  ì˜ì—­ -->
                        <TextBox x:Name="GsdContentTextBox"
                                 Grid.Row="2"
                                 AcceptsReturn="True"
                                 TextWrapping="Wrap"
                                 VerticalScrollBarVisibility="Auto"
                                 MinHeight="200"
                                 FontFamily="Consolas"
                                 FontSize="12"
                                 Background="{DynamicResource BackgroundBrush}"
                                 Foreground="{DynamicResource TextPrimaryBrush}"
                                 BorderBrush="{DynamicResource BorderBrush}"
                                 Padding="8"/>

                        <!-- ë²„íŠ¼ ì˜ì—­ -->
                        <StackPanel Grid.Row="3" Orientation="Horizontal"
                                    HorizontalAlignment="Right" Margin="0,12,0,0">
                            <Button x:Name="GsdSaveButton"
                                    Content="Save"
                                    Click="GsdSaveButton_Click"
                                    Padding="12,6"
                                    Margin="0,0,8,0"/>
                            <Button x:Name="GsdNextButton"
                                    Content="Next Step"
                                    Click="GsdNextButton_Click"
                                    Background="{DynamicResource PrimaryBrush}"
                                    Foreground="White"
                                    Padding="12,6"/>
                        </StackPanel>
                    </Grid>
                </ScrollViewer>

                <!-- Skills ì»¨í…ì¸  -->
                <ScrollViewer x:Name="SkillsContent" Visibility="Collapsed"
                              VerticalScrollBarVisibility="Auto">
                    <Grid Margin="12">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- í”„ë¡œì íŠ¸ ë¶„ì„ ìƒíƒœ -->
                        <Border Grid.Row="0"
                                Background="{DynamicResource CardBrush}"
                                CornerRadius="6"
                                Padding="12"
                                Margin="0,0,0,8">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Column="0">
                                    <TextBlock x:Name="SkillsProjectNameText"
                                               Text="í”„ë¡œì íŠ¸: (ë¶„ì„ ëŒ€ê¸°)"
                                               FontWeight="SemiBold"
                                               Foreground="{DynamicResource TextPrimaryBrush}"/>
                                    <TextBlock x:Name="SkillsStackText"
                                               Text="ê°ì§€ëœ ê¸°ìˆ : -"
                                               FontSize="11"
                                               Foreground="{DynamicResource TextSecondaryBrush}"
                                               Margin="0,4,0,0"/>
                                </StackPanel>

                                <Button Grid.Column="1"
                                        Style="{StaticResource MaterialDesignFlatButton}"
                                        Click="SkillsAnalyzeButton_Click"
                                        ToolTip="í”„ë¡œì íŠ¸ ë¶„ì„">
                                    <StackPanel Orientation="Horizontal">
                                        <materialDesign:PackIcon Kind="Magnify" VerticalAlignment="Center"/>
                                        <TextBlock Text="ë¶„ì„" Margin="4,0,0,0"/>
                                    </StackPanel>
                                </Button>
                            </Grid>
                        </Border>

                        <!-- ë¦¬ì†ŒìŠ¤ íƒ€ìž… í•„í„° -->
                        <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,8">
                            <RadioButton x:Name="SkillsFilterAll"
                                         Content="ì „ì²´"
                                         IsChecked="True"
                                         Checked="SkillsFilter_Checked"
                                         Tag="All"
                                         Margin="0,0,8,0"
                                         Foreground="{DynamicResource TextPrimaryBrush}"/>
                            <RadioButton x:Name="SkillsFilterSkills"
                                         Content="ìŠ¤í‚¬"
                                         Checked="SkillsFilter_Checked"
                                         Tag="Skill"
                                         Margin="0,0,8,0"
                                         Foreground="{DynamicResource TextPrimaryBrush}"/>
                            <RadioButton x:Name="SkillsFilterAgents"
                                         Content="ì—ì´ì „íŠ¸"
                                         Checked="SkillsFilter_Checked"
                                         Tag="Agent"
                                         Margin="0,0,8,0"
                                         Foreground="{DynamicResource TextPrimaryBrush}"/>
                            <RadioButton x:Name="SkillsFilterCommands"
                                         Content="ì»¤ë§¨ë“œ"
                                         Checked="SkillsFilter_Checked"
                                         Tag="Command"
                                         Margin="0,0,8,0"
                                         Foreground="{DynamicResource TextPrimaryBrush}"/>
                            <RadioButton x:Name="SkillsFilterHooks"
                                         Content="í›…"
                                         Checked="SkillsFilter_Checked"
                                         Tag="Hook"
                                         Foreground="{DynamicResource TextPrimaryBrush}"/>
                        </StackPanel>

                        <!-- ì¶”ì²œ ë¦¬ì†ŒìŠ¤ ëª©ë¡ -->
                        <ListBox x:Name="SkillsList" Grid.Row="2"
                                 SelectionMode="Multiple"
                                 ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                 Background="Transparent"
                                 BorderThickness="0">
                            <ListBox.ItemTemplate>
                                <DataTemplate>
                                    <Border Padding="10" Margin="0,3"
                                            Background="{DynamicResource CardBrush}"
                                            CornerRadius="6"
                                            BorderBrush="{DynamicResource BorderBrush}"
                                            BorderThickness="1">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>

                                            <!-- ì²´í¬ë°•ìŠ¤ -->
                                            <CheckBox Grid.Column="0"
                                                      IsChecked="{Binding IsSelected, Mode=TwoWay}"
                                                      VerticalAlignment="Center"
                                                      Margin="0,0,8,0"/>

                                            <!-- ì •ë³´ -->
                                            <StackPanel Grid.Column="1">
                                                <StackPanel Orientation="Horizontal">
                                                    <TextBlock Text="{Binding PriorityIcon}"
                                                               FontSize="12"
                                                               VerticalAlignment="Center"
                                                               Margin="0,0,4,0"/>
                                                    <TextBlock Text="{Binding Name}"
                                                               FontWeight="SemiBold"
                                                               Foreground="{DynamicResource TextPrimaryBrush}"/>
                                                    <Border Background="{DynamicResource PrimaryBrush}"
                                                            CornerRadius="3"
                                                            Padding="6,1"
                                                            Margin="8,0,0,0"
                                                            Visibility="{Binding IsInstalled, Converter={StaticResource BoolToVis}}">
                                                        <TextBlock Text="ì„¤ì¹˜ë¨" FontSize="10" Foreground="White"/>
                                                    </Border>
                                                </StackPanel>
                                                <TextBlock Text="{Binding Description}"
                                                           FontSize="11"
                                                           Foreground="{DynamicResource TextSecondaryBrush}"
                                                           TextWrapping="Wrap"
                                                           Margin="0,2,0,0"/>
                                                <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                                                    <Border Background="{DynamicResource BackgroundBrush}"
                                                            CornerRadius="3"
                                                            Padding="6,2">
                                                        <TextBlock Text="{Binding TypeName}"
                                                                   FontSize="10"
                                                                   Foreground="{DynamicResource TextSecondaryBrush}"/>
                                                    </Border>
                                                    <Border Background="{DynamicResource BackgroundBrush}"
                                                            CornerRadius="3"
                                                            Padding="6,2"
                                                            Margin="4,0,0,0">
                                                        <TextBlock Text="{Binding Category}"
                                                                   FontSize="10"
                                                                   Foreground="{DynamicResource TextSecondaryBrush}"/>
                                                    </Border>
                                                </StackPanel>
                                            </StackPanel>

                                            <!-- ì„¤ì¹˜ ë²„íŠ¼ -->
                                            <Button Grid.Column="2"
                                                    Style="{StaticResource MaterialDesignIconButton}"
                                                    Width="28" Height="28"
                                                    Click="InstallSingleSkill_Click"
                                                    Tag="{Binding}"
                                                    ToolTip="ì„¤ì¹˜"
                                                    IsEnabled="{Binding IsNotInstalled}">
                                                <materialDesign:PackIcon Kind="Download" Width="16" Height="16"/>
                                            </Button>
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ListBox.ItemTemplate>
                        </ListBox>

                        <!-- í•˜ë‹¨ ì»¨íŠ¸ë¡¤ -->
                        <Grid Grid.Row="3" Margin="0,8,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock x:Name="SkillsStatsText"
                                       Text="ì¶”ì²œ: 0ê°œ (ì„¤ì¹˜ë¨: 0ê°œ)"
                                       VerticalAlignment="Center"
                                       Foreground="{DynamicResource TextSecondaryBrush}"/>

                            <StackPanel Grid.Column="1" Orientation="Horizontal">
                                <Button Style="{StaticResource MaterialDesignFlatButton}"
                                        Click="SkillsSelectAllButton_Click"
                                        ToolTip="ì „ì²´ ì„ íƒ">
                                    <StackPanel Orientation="Horizontal">
                                        <materialDesign:PackIcon Kind="CheckAll" VerticalAlignment="Center"/>
                                        <TextBlock Text="ì „ì²´ ì„ íƒ" Margin="4,0,0,0"/>
                                    </StackPanel>
                                </Button>

                                <Button x:Name="SkillsInstallButton"
                                        Click="SkillsInstallSelectedButton_Click"
                                        Background="{DynamicResource SuccessBrush}"
                                        Foreground="White"
                                        Padding="12,6"
                                        Margin="8,0,0,0"
                                        ToolTip="ì„ íƒí•œ ë¦¬ì†ŒìŠ¤ ì„¤ì¹˜">
                                    <StackPanel Orientation="Horizontal">
                                        <materialDesign:PackIcon Kind="Download" VerticalAlignment="Center"/>
                                        <TextBlock Text="ì„¤ì¹˜" Margin="4,0,0,0"/>
                                    </StackPanel>
                                </Button>
                            </StackPanel>
                        </Grid>
                    </Grid>
                </ScrollViewer>
            </Grid>
        </Grid>
    </Border>
</UserControl>
