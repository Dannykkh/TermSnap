# SSH 서버 세션 가이드

> 원격 Linux 서버에 연결하고 AI의 도움으로 명령어를 실행하는 방법

---

## 목차

1. [시작하기](#시작하기)
2. [서버 연결](#서버-연결)
3. [AI 명령어 생성](#ai-명령어-생성)
4. [파일 전송 (SFTP)](#파일-전송-sftp)
5. [파일 편집기](#파일-편집기)
6. [서버 모니터링](#서버-모니터링)
7. [명령어 관리](#명령어-관리)
8. [문제 해결](#문제-해결)

---

## 시작하기

### SSH 세션이란?

SSH 세션은 원격 Linux/Unix 서버에 안전하게 연결하여 명령어를 실행하는 기능입니다. TermSnap의 SSH 세션은 일반 SSH 클라이언트(PuTTY 등)에 AI 기능을 추가하여:

- **자연어로 명령어 생성**: "nginx 재시작해줘" → `sudo systemctl restart nginx`
- **명령어 오류 자동 수정**: 권한 오류 발생 시 sudo 추가
- **위험 명령어 보호**: `rm -rf /` 같은 위험한 명령어 자동 차단

### 새 SSH 세션 시작

1. **새 탭 버튼(+)** 클릭 또는 `Ctrl+T`
2. **SSH 서버 연결** 선택
3. 저장된 서버 선택 또는 새 서버 추가

---

## 서버 연결

### 저장된 서버로 연결

저장된 서버 프로필이 있으면 클릭 한 번으로 연결:

1. 서버 목록에서 원하는 서버 선택
2. **연결** 버튼 클릭
3. 연결 성공 시 터미널 화면으로 전환

### 새 서버 추가

**설정** 또는 **새 서버 추가** 버튼 클릭 후:

```
프로필 이름: 개발 서버
호스트: 192.168.1.100
포트: 22 (기본값)
사용자 이름: ubuntu
```

### 인증 방법

#### 방법 1: 비밀번호

가장 간단한 방법:
```
인증 방법: 비밀번호
비밀번호: ********
```
- 비밀번호는 Windows DPAPI로 암호화되어 저장

#### 방법 2: SSH 키

보안이 더 강력한 방법:
```
인증 방법: SSH 키
SSH 키 파일: C:\Users\me\.ssh\id_rsa
Passphrase: ******** (선택)
```
- `.pem` 파일 (AWS EC2 등)
- `.ppk` 파일 (PuTTY 형식)
- OpenSSH 형식 (`id_rsa`)

### 서버 프로필 관리

**설정** 버튼에서:
- 프로필 편집/삭제
- 즐겨찾기 설정 (목록 상단에 표시)
- 메모 추가 (DB 접속 정보 등)

---

## AI 명령어 생성

### 기본 사용법

연결 후 입력창에 자연어로 원하는 작업 입력:

```
입력: "nginx 상태 확인해줘"
AI 생성: systemctl status nginx
```

### 자연어 명령어 예시

#### 시스템 관리
| 입력 | 생성되는 명령어 |
|------|----------------|
| "디스크 사용량 확인" | `df -h` |
| "메모리 사용량" | `free -h` |
| "시스템 정보" | `uname -a` |
| "업타임 확인" | `uptime` |

#### 프로세스 관리
| 입력 | 생성되는 명령어 |
|------|----------------|
| "CPU 많이 쓰는 프로세스 5개" | `ps aux --sort=-%cpu \| head -6` |
| "메모리 많이 쓰는 프로세스" | `ps aux --sort=-%mem \| head -11` |
| "nginx 프로세스 찾기" | `ps aux \| grep nginx` |

#### 서비스 관리
| 입력 | 생성되는 명령어 |
|------|----------------|
| "nginx 재시작" | `sudo systemctl restart nginx` |
| "apache 상태 확인" | `systemctl status apache2` |
| "docker 서비스 시작" | `sudo systemctl start docker` |

#### 로그 분석
| 입력 | 생성되는 명령어 |
|------|----------------|
| "nginx 에러 로그 50줄" | `sudo tail -n 50 /var/log/nginx/error.log` |
| "시스템 로그에서 error 찾기" | `sudo journalctl -p err -n 50` |
| "실패한 SSH 로그인 확인" | `sudo grep "Failed password" /var/log/auth.log` |

### 명령어 확인 후 실행

AI가 명령어를 생성하면:

1. **명령어 미리보기**: 생성된 명령어 확인
2. **수정 가능**: 필요시 직접 수정
3. **실행**: Enter 또는 실행 버튼

### 자동 오류 수정

명령어 실행 중 오류 발생 시 AI가 자동으로 수정 시도:

```
시도 1: cat /var/log/nginx/access.log
결과: Permission denied

AI 분석 중...

시도 2: sudo cat /var/log/nginx/access.log
결과: 성공!
```

### 위험 명령어 보호

시스템에 위험한 명령어는 자동 차단:

**완전 차단:**
- `rm -rf /`
- `dd if=/dev/zero of=/dev/sda`
- `:(){ :|:& };:` (fork bomb)

**확인 필요:**
- `rm` (삭제 명령)
- `sudo` (관리자 권한)
- `reboot`, `shutdown`
- `kill`, `pkill`

---

## 파일 전송 (SFTP)

### SFTP 창 열기

SSH 연결 상태에서 **파일 전송** 버튼 클릭

### 파일 업로드

**단일 파일:**
1. **업로드** 버튼 클릭
2. 로컬 파일 선택
3. 전송 시작 (100-150 MB/s)

**다중 파일 (병렬 전송):**
1. **업로드** 버튼 클릭
2. `Ctrl+클릭`으로 여러 파일 선택
3. 4개씩 동시 전송 (최대 400 MB/s)

### 파일 다운로드

**단일 파일:**
1. 원격 파일 목록에서 파일 선택
2. **다운로드** 버튼 클릭
3. 저장 위치 선택

**다중 파일:**
1. `Ctrl+클릭` 또는 `Shift+클릭`으로 여러 파일 선택
2. **다운로드** 버튼 클릭
3. 저장 폴더 선택

### 파일 관리

- **새 폴더**: 원격에 새 폴더 생성
- **이름 변경**: 파일/폴더 이름 변경
- **삭제**: 파일/폴더 삭제 (확인 필요)

### 전송 속도

| 모드 | 속도 | 비교 |
|------|------|------|
| 단일 파일 | 100-150 MB/s | FileZilla 대비 3-5배 |
| 병렬 4개 | 400 MB/s | 업계 최고 수준 |

---

## 파일 편집기

### 파일 열기

SFTP 창에서 텍스트 파일 더블클릭

### 뷰어 모드 (기본)

- **읽기 전용**: 실수로 수정 방지
- **회색 배경**: 뷰어 모드임을 표시
- 구문 강조, 줄 번호 표시

### 편집 모드

1. **편집** 버튼(연필 아이콘) 클릭
2. 파일 내용 수정
3. **저장**(Ctrl+S) 또는 **취소**

### 지원 기능

- **구문 강조**: C#, Python, JavaScript, JSON, XML 등 20개 이상 언어
- **코드 접기**: `{}` 블록, XML 태그 접기
- **줄 번호**: 좌측에 표시
- **인코딩**: UTF-8, EUC-KR 등 선택
- **줄 끝 문자**: CRLF/LF 표시

### 편집기 단축키

| 단축키 | 기능 |
|--------|------|
| `Ctrl+S` | 저장 |
| `Ctrl+Z` | 실행 취소 |
| `Ctrl+Y` | 다시 실행 |
| `Ctrl+F` | 찾기 |
| `Ctrl+H` | 찾아 바꾸기 |
| `Ctrl+G` | 줄 이동 |

---

## 서버 모니터링

### 모니터 창 열기

SSH 연결 상태에서 **서버 모니터링** 버튼 클릭

### 모니터링 항목

- **CPU 사용률**: 현재 CPU 사용량 (%)
- **메모리 사용률**: 사용 중 / 전체
- **디스크 사용률**: 파티션별 사용량
- **네트워크**: 송수신 데이터량
- **시스템 정보**: OS, 커널, 업타임
- **서비스 상태**: nginx, apache, mysql 등
- **상위 프로세스**: CPU/메모리 사용량 순

### 자동 갱신

**자동 갱신** 체크박스 활성화 시 10초마다 자동 업데이트

---

## 명령어 관리

### 명령어 히스토리

**히스토리** 버튼 또는 `Ctrl+Shift+H`:

- 실행한 모든 명령어 기록
- 성공/실패 상태 표시
- 프로필별 필터링
- 검색 기능

### 명령어 스니펫

자주 쓰는 명령어 저장:

1. **스니펫 관리** 버튼 클릭
2. **새 스니펫** 클릭
3. 정보 입력:
   - 이름: Nginx 재시작
   - 명령어: `sudo systemctl restart nginx`
   - 카테고리: 웹서버
   - 태그: nginx, 재시작

### Q&A 지식 베이스

자주 묻는 질문과 답변 저장:

1. **Q&A 관리** 버튼 클릭
2. **새 항목** 클릭
3. 정보 입력:
   - 질문: nginx 재시작 방법
   - 답변: sudo systemctl restart nginx
   - 카테고리: 웹서버

**효과:**
- 동일 질문 시 즉시 답변 (API 호출 없음)
- API 토큰 절약
- 임베딩 기반 유사 질문 검색

---

## 문제 해결

### 연결 실패

**"Connection refused"**
- 서버 IP/포트 확인
- 서버에서 SSH 서비스 실행 확인: `sudo systemctl status sshd`
- 방화벽에서 22번 포트 허용 확인

**"Authentication failed"**
- 사용자명/비밀번호 재확인
- SSH 키 파일 경로 확인
- SSH 키 권한 확인 (Linux에서 600)

**"Host key verification failed"**
- 서버 재설치 후 발생
- `~/.ssh/known_hosts`에서 해당 호스트 항목 삭제

### 명령어 실행 오류

**"Permission denied"**
- sudo 권한 확인
- 해당 사용자에 sudo 권한 부여 필요

**"Command not found"**
- 명령어 경로 확인
- 패키지 설치 필요 (`apt install` 또는 `yum install`)

### 파일 전송 실패

**느린 속도**
- 네트워크 상태 확인
- 서버 부하 확인
- 다른 전송 프로그램 동시 사용 확인

**"Permission denied" (업로드)**
- 원격 디렉토리 쓰기 권한 확인
- 디스크 공간 확인

---

## 팁

### 효율적인 명령어 요청

**좋은 예:**
- "nginx 에러 로그에서 오늘 발생한 500 에러 찾아줘"
- "/var/www 폴더에서 1GB 이상인 파일 찾아줘"

**나쁜 예:**
- "확인해줘" (무엇을?)
- "문제 해결해줘" (어떤 문제?)

### 서버 메모 활용

프로필에 중요 정보 메모:
```
MySQL 접속:
- host: localhost
- user: root
- password: mysql_pass

중요 경로:
- 웹루트: /var/www/html
- 로그: /var/log/nginx
```

### 스니펫으로 반복 작업 자동화

자주 쓰는 명령어는 스니펫으로 저장해서 클릭 한 번에 실행

---

**관련 문서:**
- [로컬 터미널 가이드](LOCAL_TERMINAL_GUIDE.ko.md)
- [AI 워크플로우 가이드](AI_WORKFLOW_GUIDE.ko.md)
- [FAQ](FAQ.md)
